<beans:beans
	xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/security
	http://www.springframework.org/schema/security/spring-security.xsd">

	<!-- enable use-expressions -->
	<http security="none" pattern="/resources/**" />
	<http auto-config="true" use-expressions="true">

		<intercept-url pattern="/nic/**"
			access="hasRole('ROLE_NIC')" />

		<intercept-url pattern="/user/addChangePassword/**"
			access="isAuthenticated()" />

		<intercept-url pattern="/user/checkPassword/**"
			access="isAuthenticated()" />

		<intercept-url pattern="/user/changePassword/**"
			access="isAuthenticated()" />

		<intercept-url pattern="/user/viewProfile/**"
			access="isAuthenticated()" />

		<intercept-url pattern="/user/addSign/**"
			access="isAuthenticated()" />

		<intercept-url pattern="/user/saveSign/**"
			access="isAuthenticated()" />

		<intercept-url pattern="/user/listDomestic/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/viewDomesticDetails/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url
			pattern="/user/listCheckpostDomesticEntry/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url
			pattern="/user/listDomesticCheckpostPassed/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/listPravasi/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/viewPravasicDetails/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/addPatientSearch/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/listPatient/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/getsuspect/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/addPrescriptionReport/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url
			pattern="/user/getPrescriptionReportPatient/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/getPrescriptionReport/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url
			pattern="/user/listMedicalPassInterState/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />


		<intercept-url pattern="/user/listMedicalPass/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/getMedicalPass/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/downloadAttachment/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/saveMedicalRemark/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC','ROLE_CDMO')" />

		<intercept-url pattern="/user/**"
			access="hasAnyRole('ROLE_DC','ROLE_DO','ROLE_CU','ROLE_FDC')" />

		<intercept-url pattern="/dmoRto/**"
			access="hasAnyRole('ROLE_DMO','ROLE_RTO')" />

		<intercept-url pattern="/localBody/**"
			access="hasRole('ROLE_LB')" />

		<intercept-url pattern="/stm/**"
			access="hasRole('ROLE_STM')" />

		<intercept-url pattern="/taluk/**"
			access="hasRole('ROLE_TO')" />

		<intercept-url pattern="/medicalOfficer/getsuspect/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/medicalOfficer/**"
			access="hasRole('ROLE_MO')" />

		<intercept-url pattern="/corona/listPatient/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/removeMapping/**"
			access="hasRole('ROLE_MO')" />

		<intercept-url pattern="/corona/getPatient/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/addhealtStatus/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/uploadHealthStatus/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/saveHealthStatus/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/getHealthStatus/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/editSuspect/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/deleteHealthStatus/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/releaseSuspect/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/listPHCByLocalBody/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/saveCoronaSuspects/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/listPHC/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/deleteSuspect/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/listDeletePatient/**"
			access="hasAnyRole('ROLE_MO','ROLE_RRT')" />

		<intercept-url pattern="/corona/declineSuspect/**"
			access="hasRole('ROLE_MO')" />

		<intercept-url
			pattern="/corona/declineReleaseSuspect/**"
			access="hasRole('ROLE_MO')" />

		<intercept-url pattern="/corona/**"
			access="hasRole('ROLE_RRT')" />

		<intercept-url pattern="/village/**"
			access="hasRole('ROLE_VO')" />

		<intercept-url pattern="/akshaya/**"
			access="hasRole('ROLE_VUE')" />

		<intercept-url pattern="/state/trainTravelerList/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url
			pattern="/state/listTrainTravelerByDistrict/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url pattern="/state/viewDomesticDetails/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url pattern="/state/approveDomesticPass/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url
			pattern="/state/rejectDomesticPassEntry/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url
			pattern="/state/listTrainTravelerApprovedByDistrict/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url
			pattern="/state/addApprovedtravelerList/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url pattern="/state/printDomesticPermit/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url
			pattern="/state/addRejectedtravelerList/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url
			pattern="/state/listTrainTravelerRejectedByDistrict/**"
			access="hasAnyRole('ROLE_STA','ROLE_FSTA')" />

		<intercept-url pattern="/state/addTrain/**"
			access="hasRole('ROLE_STA')" />

		<intercept-url pattern="/state/saveTrain/**"
			access="hasRole('ROLE_STA')" />


		<intercept-url pattern="/state/listAllPatient/**"
			access="hasAnyRole('ROLE_SOP')" />

		<intercept-url pattern="/state/listPatientByDistrict/**"
			access="hasAnyRole('ROLE_SOP')" />

		<intercept-url pattern="/state/getsuspect/**"
			access="hasAnyRole('ROLE_SOP')" />

		<intercept-url pattern="/state/**"
			access="hasAnyRole('ROLE_SO','ROLE_SOP')" />

		<intercept-url pattern="/hospital/**"
			access="hasRole('ROLE_HO')" />

		<intercept-url pattern="/juniorDoctor/**"
			access="hasRole('ROLE_JD')" />

		<intercept-url pattern="/airport/**"
			access="hasRole('ROLE_AP')" />

		<intercept-url pattern="/checkpost/**"
			access="hasRole('ROLE_CP')" />

		<intercept-url pattern="/nodal/**"
			access="hasRole('ROLE_NO')" />

		<intercept-url pattern="/home/**" access="permitAll" />

		<access-denied-handler error-page="/error403" />

		<form-login login-page="/home/loginPage"
			default-target-url="/home/loginReq"
			login-processing-url="/home/login"
			authentication-failure-handler-ref="customAuthenticationFailureHandler"
			authentication-success-handler-ref="customAuthenticationSuccessHandler"
			username-parameter="username" password-parameter="password" />

		<remember-me key="uniqueAndSecret" />

		<logout logout-success-url="/home/loginPage"
			delete-cookies="JSESSIONID" logout-url="/home/logout"
			invalidate-session="true" />

		<session-management>
			<concurrency-control max-sessions="1"
				error-if-maximum-exceeded="false"
				expired-url="/home/loginPage?another" />
		</session-management>

		<!-- enable csrf protection -->
		<csrf />
		<!-- enable xxs protection header -->
		<headers>
			<cache-control />
			<content-type-options />
			<!-- <hsts /> -->

			<frame-options />
			<xss-protection />
			<!-- <content-security-policy report-only="true" policy-directives="X-Content-Security-Policy, 
				script-src ' self '" /> -->
		</headers>
	</http>

	<authentication-manager>
		<authentication-provider
			user-service-ref="userDetailsServiceImpl">
			<password-encoder hash="bcrypt" />
		</authentication-provider>
	</authentication-manager>

</beans:beans>
